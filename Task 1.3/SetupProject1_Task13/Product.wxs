<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

	<!-- Product Details -->
	<Product
		Id="*"
		Name="Task1_3"
		Language="1033"
		Version="1.0.0.0"
		Manufacturer="Ivan Hoan Jia Wei"
		UpgradeCode="993569E5-AE2F-423A-A2B7-026B6DF7513B">
		
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

		<!-- Update -->
		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
		<MediaTemplate EmbedCab ="yes"/>

		<!-- Icon File Setting -->
		<Icon Id="AppIcon.exe" SourceFile="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/calculator.ico" />
		<!-- Setting the Icon in Control Panel -->
		<Property Id="ARPPRODUCTICON" Value="AppIcon.exe" />

		<!-- Function -->
		<Feature Id="ProductFeature" Title="Task1_3" Level="1">
			<ComponentGroupRef Id="ProductComponents" />
			<ComponentRef Id="DesktopShortcut" />
		</Feature>
	</Product>

	<!-- Program Install Location-->
	<Fragment>
		<!-- Main Program Location-->
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder" Name="SetupProject_Task1_3">
				<Directory Id="INSTALLFOLDER" Name="SetupProject_Task1_3">
					<Directory Id="IconFolder" Name="icon"/>
				</Directory>
			</Directory>

			<!-- Desktop Shortcut Location-->
			<Directory Id="DesktopFolder" Name="Desktop" />
		</Directory>
	</Fragment>

	<Fragment>
		<ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
			<!-- Main Apps -->
			<Component Id="MainExecutable" Guid="3EAE6901-FFC6-42CE-96D9-BBEB4D9373DE">
				<File
					Id ="MainEXE"
					Name ="WinFormsApp1_Task13.exe"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/WinFormsApp1_Task13.exe"
					KeyPath="yes">
				</File>
			</Component>
			
			<!-- Other Apps -->
			<Component Id="Others" Guid="C9BE53A3-BC1B-44E9-B01D-BF78D8641A8D">

				<File
					Id ="icon"
					Name="calculator.ico"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/calculator.ico">
				</File>

				<File
					Id ="json1"
					Name="WinFormsApp1_Task13.deps.json"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/WinFormsApp1_Task13.deps.json">
				</File>

				<File
					Id ="dll1"
					Name="WinFormsApp1_Task13.dll"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/WinFormsApp1_Task13.dll">
				</File>

				<File
					Id ="pdb1"
					Name="WinFormsApp1_Task13.pdb"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/WinFormsApp1_Task13.pdb">
				</File>

				<File
					Id ="json2"
					Name="WinFormsApp1_Task13.runtimeconfig.json"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/WinFormsApp1_Task13.runtimeconfig.json">
				</File>

				<File
					Id ="dll2"
					Name="WinFormsLibrary1_Task13.dll"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/WinFormsLibrary1_Task13.dll">
				</File>

				<File
					Id ="pdb2"
					Name="WinFormsLibrary1_Task13.pdb"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/WinFormsLibrary1_Task13.pdb">
				</File>

				<File
					Id ="pdb3"
					Name="WinFormsLibrary2_Task13.pdb"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/WinFormsLibrary2_Task13.pdb">
				</File>

				<File
					Id ="dll3"
					Name="WinFormsLibrary2_Task13.dll"
					Source="../WinFormsApp1_Task13/bin/Debug/net8.0-windows/WinFormsLibrary2_Task13.dll">
				</File>
				
			</Component>
		</ComponentGroup>
	</Fragment>

	<!-- ShortCut -->
	<Fragment>
		
		<!-- Desctop Shortcut -->
		<DirectoryRef Id="DesktopFolder">
			<Component Id="DesktopShortcut" Guid="60D4EB28-D35E-43BB-B704-998899A96BEB">
				<Shortcut Id="DesktopShortcut"
						  Name="Task1_3"
						  Description="This is the program for SWE30049 Task 1.3"
						  Target="[INSTALLFOLDER]WinFormsApp1_Task13.exe"
						  WorkingDirectory="INSTALLFOLDER"
						  Icon="AppIcon.exe" />

				<!-- Registry Key -->
				<RegistryValue Root="HKCU"
								Key="Software\Ivan Hoan Jia Wei\Task1_3"
								Name="installed"
								Type="integer"
								Value="1"
								KeyPath="yes"/>
			</Component>
		</DirectoryRef>
	</Fragment>

</Wix>
